# Excel転記システム 使い方マニュアル

## はじめに
このシステムは、たくさんのExcelファイルから必要なデータを自動で集めてくれる便利なツールです。
手作業でコピー＆ペーストする必要がなくなります！

## 準備するもの
1. このExcelファイル（転記システム.xlsm）
2. データを取り出したいExcelファイル（複数可）
3. 少しの時間（ファイル100個で約5分）

---

## 使い方（5つのステップ）

### ステップ1：フォーマットシートの準備
1. 「フォーマット」シートを開く
2. データを取りたいファイルと同じような形を作る
3. 取り出したいデータの場所に「TENKI01」「TENKI02」などを入力

**例：売上ファイルから会社名と金額を取り出したい場合**
```
A列          B列
会社名       TENKI01  ← ここに入力
売上金額     TENKI02  ← ここに入力
```

### ステップ2：マスタシートの準備
1. 「マスタ」シートを開く
2. 以下のように入力：

```
A列（フォルダの場所）    B列（ファイル名）
フォルダパス            ファイル名         ← 1行目（見出し）
C:\売上データ\          2024年1月.xlsx    ← 2行目から
C:\売上データ\          2024年2月.xlsx
C:\売上データ\          2024年3月.xlsx
```

**フォルダの場所の調べ方：**
- ファイルを右クリック → プロパティ → 場所をコピー

### ステップ3：実行
1. どのシートでもOK、「データ転記実行」ボタンをクリック
2. 「プレビューを表示しますか？」→「はい」がおすすめ
3. プレビューを確認して「転記を実行しますか？」→「はい」

### ステップ4：結果の確認
- 新しいシート「転記結果_日付_時刻」が自動で作成されます
- データが表形式で整理されています
- 一番下に処理結果のまとめが表示されます

### ステップ5：エラーがあった場合
- 「エラーログを出力しますか？」→「はい」
- エラーの詳細が別シートに表示されます

---

## よくある質問

### Q1：TENKI番号は順番じゃなくても大丈夫？
**A：** 大丈夫です！TENKI01、TENKI03、TENKI10のように飛び番でもOK

### Q2：ファイルが見つからないエラーが出る
**A：** マスタシートのファイル名や場所を確認してください
- ファイル名の入力ミス（全角・半角の違いなど）
- フォルダの場所が間違っている

### Q3：処理に時間がかかる
**A：** ファイル数により時間がかかります
- 50ファイル：約2-3分
- 100ファイル：約5分
- 200ファイル：約10分

### Q4：結果がおかしい
**A：** フォーマットシートを確認してください
- TENKI番号の位置が転記元ファイルと合っているか
- 全角・半角の入力ミスがないか

---

## 便利な機能

### プレビュー機能
実行前にデータを確認できます。間違いを防げて安心！

### エラーログ
問題があったファイルが一覧で見られます。原因もわかりやすい！

### 進捗表示
画面下に「処理中...50%（50/100）残り：約2.5分」のように表示されます

### 自動整形
結果が見やすく色分けされて、罫線も自動で引かれます

---

## 注意事項

1. **マクロを有効にする**
   - ファイルを開いた時に「マクロを有効にする」を選んでください

2. **ファイル名は正確に**
   - 大文字・小文字、全角・半角の違いに注意

3. **同じ形式のファイルのみ**
   - 転記元のファイルは全て同じレイアウトである必要があります

4. **保存を忘れずに**
   - 転記結果は自動保存されません。必要なら保存してください

---

## 困ったときは

1. エラーメッセージをメモする
2. エラーログシートを確認する
3. マスタシートとフォーマットシートを再確認する

それでも解決しない場合は、システム管理者にご相談ください。