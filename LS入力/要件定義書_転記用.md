# Outlook予定取得Excelマクロ システム要件定義書

## 1. 概要
Excelの特定セルに入力された日付に基づき、自身のOutlook予定表から予定を自動で取得し、指定された形式でシートに一覧表示するVBAマクロを開発する。

## 2. 機能要件

### 2.1 基本機能
- Excelシートの特定セルから日付を取得する。
- 取得した日付に該当する自身のOutlook予定を全件取得する。
- 取得した予定を指定の形式でExcelシートに出力する。

### 2.2 入力仕様
| 項目 | 詳細 |
|---|---|
| 対象シート | `データ取得` |
| 日付入力セル | `C3` |
| 日付形式 | 日付形式 (`2025/7/25`) またはシリアル値に対応 |

### 2.3 データ取得仕様
| 項目 | 詳細 |
|---|---|
| 取得対象 | 自身のOutlook予定表にある全ての予定（定期的な予定も含む） |
| 対象日 | セル`C3`で指定された日の `00:00` から `23:59` までに存在する予定 |
| 取得データ | 開始時刻、終了時刻、件名 |

### 2.4 出力仕様
| 項目 | 詳細 |
|---|---|
| 出力先シート | `データ取得` |
| 出力開始セル | `B8` |
| 出力形式 | 表形式。1行に1予定を時系列（開始時刻順）で出力 |
| ヘッダー | B7:「時間」、C7:「件名」、D7:「会議時間(HHMM)」 |

#### 出力項目詳細
| 列 | 項目 | 形式 | 例 |
|---|---|---|---|
| B | 時間 | `HHMM-HHMM` （24時間表記） | `1300-1430` |
| C | 件名 | テキスト | `プロジェクト定例会議` |
| D | 会議時間(HHMM) | `HHMM` | `0130` (90分の場合) |

---

## 3. 非機能要件

### 3.1 実行環境
| 項目 | 詳細 |
|---|---|
| アプリケーション | Microsoft Excel (VBA対応版), Microsoft Outlook (デスクトップ版) |
| OS | Windows |

### 3.2 エラーハンドリング
- 発生したエラーの種類に応じて、ユーザーに原因と対処法を分かりやすく提示する。
    - **シート名不正**: 対象シートが存在しない場合にエラーメッセージを表示。
    - **日付入力エラー**: C3セルが空欄、または日付として認識できない場合にエラーメッセージを表示。
    - **Outlook接続エラー**: Outlookへの接続に失敗した場合（未起動、インストール不正など）にエラーメッセージを表示。
    - **その他エラー**: 上記以外の予期せぬエラーが発生した場合、エラー番号と内容を表示。

### 3.3 保守性
- コード内の設定値（セル番地、シート名）は定数として管理し、変更を容易にする。
- 各処理ブロックの目的が直感的に理解できるよう、コード内にシンプルなコメントを記載する。

---

## 4. 処理フロー
1. マクロ実行
2. `データ取得`シートの`C3`セルから日付を取得
3. 日付が有効かチェック
4. `B8`セル以下の既存データをクリアし、`B7`行にヘッダーを作成
5. Outlookアプリケーションへ接続
6. 指定日の予定をフィルタリングして取得
7. 取得した予定を1件ずつ`B8`セルから下方向に出力
8. 処理が完了したら、取得件数をメッセージで表示
9. (エラー発生時) 状況に応じたエラーメッセージを表示して処理を中断
10. マクロ終了