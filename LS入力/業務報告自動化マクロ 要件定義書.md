# **業務報告自動化マクロ 要件定義書**

## **1\. 概要**

本ドキュメントは、Microsoft Excelで動作するVBAマクロ「業務報告自動化マクロ」の要件を定義するものである。  
本マクロは、Microsoft Outlookの予定情報と連携し、日々の作業実績の入力から月次の集計レポートへの転記までの一連のプロセスを自動化・省力化することを目的とする。

## **2\. 背景と目的**

### **2.1. 背景**

従来、作業者は日々の業務内容と作業時間を手作業で管理し、月末に月次報告書へ転記していた。このプロセスには、以下のような課題があった。

* Outlookの予定表から作業実績を手で転記する際に、入力ミスや漏れが発生しやすい。  
* 日々の実績入力と月次の集計作業に多くの工数がかかっている。  
* データのフォーマットが統一されておらず、集計作業が煩雑である。

### **2.2. 目的**

本マクロは、これらの課題を解決するために開発される。具体的な目的は以下の通り。

* **作業の効率化**: Outlookからの予定取得、および月次データへの転記を自動化し、作業工数を削減する。  
* **正確性の向上**: 手作業による転記ミスや計算ミスを防ぎ、データの信頼性を高める。  
* **作業負荷の軽減**: 定型的な報告作業から作業者を解放し、本来の業務に集中できる環境を提供する。

## **3\. 用語定義**

| 用語 | 説明 |
| :---- | :---- |
| **データ取得シート** | Outlookから取得した予定を一時的に表示するためのシート。 |
| **データ登録シート** | ユーザーがその日の作業実績（作業No、区分、時間）を最終的に入力するシート。 |
| **月次データシート** | 「データ登録シート」から転記された日々の作業時間を、日付ごと・区分ごとに集計・格納するマスターシート。 |

## **4\. システム構成**

本システムは、以下のコンポーネントで構成される。

* **Excelブック (.xlsm)**: マクロ本体と、上記3つのデータシートを含む。  
* **VBAマクロ**:  
  1. **Outlook予定取得マクロ**: Outlookから予定を取得する。  
  2. **データ転記・集計マクロ**: 入力データを月次シートへ転記・集計する。  
  3. **データクリアマクロ**: 各シートの入力欄を初期化する。

## **5\. 機能要件**

### **5.1. Outlook予定取得機能 (GetOutlookSchedule)**

| ID | 要件内容 | 備考 |
| :---- | :---- | :---- |
| 5.1.1 | **日付指定**: 「データ取得」シートの指定セル（C3）に入力された日付を基準に、Outlookの予定を検索できること。 |  |
| 5.1.2 | **予定取得**: 指定された日付の予定をOutlookの予定表から全て取得できること。定期的な予定も対象とする。 |  |
| 5.1.3 | **データ出力**: 取得した予定の「時間（HHMM-HHMM）」「件名」「会議時間（HHMM形式）」を「データ取得」シートの指定された行（7行目）以降に一覧表示すること。 |  |
| 5.1.4 | **データクリア**: 予定取得の実行前に、前回の出力結果を自動でクリアすること。 |  |
| 5.1.5 | **任意日付転記**: 「データ取得」シートの指定セル（C4）に入力された日付を、「データ登録」シートの任意日付セル（D4）へ自動で転記できること。 | 予定日と報告日が異なる場合に対応するため。 |
| 5.1.6 | **エラー処理**: 日付が未入力の場合やOutlookに接続できない場合に、エラーメッセージを表示して処理を安全に中断すること。 |  |

### **5.2. データ転記・集計機能 (TransferDataToMonthlySheet)**

| ID | 要件内容 | 備考 |
| :---- | :---- | :---- |
| 5.2.1 | **データソース**: 「データ登録」シートの指定範囲（8行目以降）に入力された「作業No」「区分」「時間」を転記対象とすること。 |  |
| 5.2.2 | **転記日特定**: 「データ登録」シートの登録日セル（D3またはD4）の日付を基に、「月次データ」シートから対応する日付の行を自動で検索すること。 | D4（任意日付）が入力されている場合はそちらを優先する。 |
| 5.2.3 | **プレビュー表示**: 転記を実行する前に、区分ごとの合計時間を算出し、確認ダイアログにプレビュー表示すること。 | ユーザーの意図しない転記を防ぐ。 |
| 5.2.4 | **ユーザー確認**: プレビュー表示後、ユーザーが「はい」「いいえ」で転記の実行を選択できること。「いいえ」の場合は処理を中断する。 |  |
| 5.2.5 | **データ転記**: ユーザーが「はい」を選択した場合、「データ登録」シートの各行の「時間」を、「月次データ」シートの対応する日付・区分のセルに転記すること。 | 同一区分・同一日のデータは上書きされる。 |
| 5.2.6 | **クリップボードコピー**: 転記対象となったデータの一覧を、タブ区切りのテキストとしてクリップボードにコピーすること。 | 他アプリケーションへの貼り付けを想定。 |
| 5.2.7 | **エラー処理**: 転記先の日付が見つからない場合や、転記対象データがない場合に、メッセージを表示して処理を中断すること。 |  |

### **5.3. データクリア機能 (ClearInputData)**

| ID | 要件内容 | 備考 |
| :---- | :---- | :---- |
| 5.3.1 | **ユーザー確認**: データをクリアする前に、確認ダイアログを表示し、ユーザーの意思を確認すること。 | 誤操作によるデータ消失を防ぐ。 |
| 5.3.2 | **データ消去**: 「データ取得」シートおよび「データ登録」シートの指定された入力範囲をクリアすること。 | 次回の入力に備えるため。 |

## **6\. 非機能要件**

### **6.1. 操作性**

* 各機能はExcelシート上に配置されたボタンから実行できること。  
* 処理の節目（完了、エラー、確認）では、ユーザーに状況を伝えるダイアログボックスを表示すること。

### **6.2. 信頼性**

* 処理中に予期せぬエラーが発生した場合、エラー内容をユーザーに通知し、Excelが強制終了しないようにすること。  
* シートがパスワードで保護されている場合でも、パスワードをユーザーに要求して処理を続行できること。処理後は元の保護状態に戻すこと。

### **6.3. 互換性**

* **OS**: Windows 10 / 11  
* **アプリケーション**: Microsoft Excel 2016以降, Microsoft Outlook 2016以降 (いずれも32bit/64bit版に対応)

## **7\. 画面・UI要件**

本マクロは既存のExcelシートを操作するため、新たな画面設計は不要とする。ただし、各シートは以下の役割を担う前提で設計されている。

* **データ取得シート**: Outlookからのデータ取得と、任意日付の指定を行うUI。  
* **データ登録シート**: 日々の作業実績を入力するUI。  
* **月次データシート**: 集計結果を閲覧するためのレポート。

## **8\. その他**

* 特になし。